<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="imageMapper">

	<!-- 이미지 조회 결과 매핑 -->
	<resultMap type="Image" id="imageResultSet">
		<result property="imgNo" column="img_no"/>
		<result property="postingNo" column="posting_no"/>
		<result property="imgFile" column="img_file"/>
	</resultMap>

	<!-- 이미지 등록 -->
	<!-- img_no는 AUTO_INCREMENT라서 INSERT에서 제외 -->
	<insert id="insertImgFile">
		INSERT INTO IMAGE (
			POSTING_NO,
			IMG_FILE
		)
		VALUES (
			#{postingNo},
			#{imgFile}
		)
	</insert>

	<!-- 게시글별 이미지 목록 조회 -->
	<select id="selectImgList" resultMap="imageResultSet">
		SELECT 
			IMG_NO,
			POSTING_NO,
			IMG_FILE
		FROM IMAGE
		WHERE POSTING_NO = #{postingNo}
		ORDER BY IMG_NO ASC
	</select>

</mapper>
